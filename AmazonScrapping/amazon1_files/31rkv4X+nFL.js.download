(function(f){var g=window.AmazonUIPageJS||window.P,m=g._namespace||g.attributeErrors,h=m?m("AllOffersDisplayIngressAssets",""):g;h.guardFatal?h.guardFatal(f)(h,window):h.execute(function(){f(h,window)})})(function(f,g,m){f.execute("all-offers-display-ingress-init",function(){var h=g.uet,p=g.uex;"function"===typeof h&&h("bb","aod-ingress-assets-load-time",{wb:1});f.when("A","jQuery","all_offers_display_ingress_utils","all-offers-display-register-state","all_offers_display_ingress_csm_counters").execute("all_offers_display_ingress_load_AOD_assets",
function(a,b,c,k,d){function l(e){f.now().execute(function(c){c!==m||k.isMarkerOverrideRegistered()||("function"===typeof q&&q("bb","aod-main-assets-injection",{wb:1}),f.register("aodIngressClick"),f.register("aodDeclarativeEvent",function(){return e}),k.setMarkerOverrideTriggered())})}var q=g.uet;a.state("aod:assetsLoaded",{isAodAssetsLoaded:!0});d.triggerUnitCounter("aodIngressAssetsLoadCtr");a.declarative("show-all-offers-display","click",function(e){e.$event.preventDefault();e.$event.stopPropagation();
e&&e.data&&e.data.ingressName&&d.incrementAndTriggerCounter(e.data.ingressName+"LoadAod");e&&e.data&&e.data.daodiDesktopExp2Treatment&&d.incrementAndTriggerCounter("daodiDesktopExp2MetricTreatment"+e.data.daodiDesktopExp2Treatment);!a.state("aod:assets2Loaded")&&c.isClickOnAODIngressSupported(e)&&(l(e),f.when("aod-load-event-handler","aodDeclarativeEvent").execute(function(c,e){e&&e.data&&(e.data.pc="dp");c.renderAodAction(e)}))});a.declarative("s-show-all-offers-display","click",function(e){e.$event.preventDefault();
e.$event.stopPropagation();!a.state("aod:assets2Loaded")&&c.isClickOnAODIngressSupported(e)&&(l(e),f.when("search-all-offers-display-util","aodDeclarativeEvent").execute(function(e,c){e.searchOnClickHandler(c)}))});a.declarative("all-offers-display-show-from-morpheus","click",function(e){e.$event.preventDefault();e.$event.stopPropagation();!a.state("aod:assets2Loaded")&&c.isClickOnAODIngressSupported(e)&&(l(e),f.when("all-offers-display-morpheus-util","aodDeclarativeEvent").execute(function(e,c){e.openAODFromMorpheus(c)}))})});
f.when("A","jQuery","all-offers-display-register-state","all_offers_display_ingress_csm_counters").execute("all-offers-display-enable-compare",function(a,b,c,k){var d=g.uet;a.state("aod:assets2Loaded")||(a=g.location.href.split("?"),1<a.length&&(a=a[1].toLowerCase().split(/[&,#]/))&&-1!==a.indexOf("aod\x3d1")&&f.now().execute(function(b){b===m&&(c.isMarkerOverrideRegistered()?k.incrementAndTriggerCounter("aodAutoLoadMarkerOverrideSetCtr"):(k.triggerUnitCounter("aodAutoLoadAssetsRequestedCtr"),"function"===
typeof d&&d("bb","aod-main-assets-injection-auto-load",{wb:1}),f.register("aodIngressClick"),c.setMarkerOverrideTriggered()))}))});f.when("A","jQuery","all_offers_display_ingress_olp_hyperlink").register("all_offers_display_ingress_utils",function(a,b,c){return{isClickOnAODIngressSupported:function(b){return c.getOlpHyperlink(b)?!0:!1}}});f.register("all_offers_display_ingress_csm_counters",function(){var a=g.ue;return{incrementAndTriggerCounter:function(b){a&&a.count&&a.count(b,(a.count(b)||0)+1)},
triggerUnitCounter:function(b){a&&a.count&&a.count(b,1)}}});f.when("all_offers_display_ingress_csm_counters").register("all_offers_display_ingress_aod_supported",function(a){return{isPropertySupported:function(b,c,k){var d=typeof b[c]===k;if(!d){var l={};b.tagName&&(l.tagName=b.tagName);b.getAttribute&&"function"===typeof b.getAttribute&&(b.getAttribute("id")&&(l.id=b.getAttribute("id")),b.getAttribute("class")&&(l.class=b.getAttribute("class")),b.getAttribute("href")&&(l.href=b.getAttribute("href")));
b="aodPropertyUnsupportedMessage, element: "+JSON.stringify(l);f.log(b+(", propertyName: "+c+", propertyType: "+k),"WARN","aodPropertyUnsupportedMessage");a.triggerUnitCounter("aodPropertyUnsupportedMessage")}return d}}});f.when("A","jQuery","all_offers_display_ingress_aod_supported").register("all_offers_display_ingress_olp_hyperlink",function(a,b,c){return{getOlpHyperlink:function(a){if(a&&a.$event&&a.$event.target){var d=a.$event.target;if("A"===d.nodeName&&d.href)return d.href;if(c.isPropertySupported(a.$event.target,
"closest","function"))return(a=d.closest("a"))?a.href:null;if(a=b(d).closest("a"))return a.attr("href")}return null}}});f.when().register("all-offers-display-register-state",function(){var a=!1;return{isMarkerOverrideRegistered:function(){return a},setMarkerOverrideTriggered:function(){a=!0}}});"use strict";f.when("A","mbc_constants","all_offers_display_ingress_csm_counters").register("mbc_atc_cart_api_ajax_controller",function(a,b,c){var k=m,d;return{mbcAtcAjaxCall:function(d){k?c.incrementAndTriggerCounter(b.MBC_ATC_CLICK_CANCELLED_CSM_METRIC):
k=a.$.ajax({url:d.url,type:d.type,data:d.data,cache:!1,headers:d.headers,xhrFields:d.xhrFields,success:d.successHandler,error:d.errorHandler,timeout:d.timeout||1E4})},updateCartCount:function(a){f.when("EWC").execute(function(c){d=c});d!==m&&"function"===typeof d.refresh?(d.refresh(),c.triggerUnitCounter(b.MBC_EWC_REFRESH_API_CSM_METRIC_SCOPE_NAME)):(f.when("nav.setCartCount").execute(function(c){c(a)}),c.triggerUnitCounter(b.MBC_NAV_API_CSM_METRIC_SCOPE_NAME))},resetAjaxHandler:function(){k=m}}});
"use strict";f.when("A","mbc_constants","mbc_cart_api_handler").execute("mbc_atc_action_handler",function(a,b,c){a.declarative("mbc-atc-action",b.MBC_WIDGET_TRIGGER_EVENTS,function(a){c.addToCart(a.data,!0)})});"use strict";f.when("A","jQuery","mbc_constants","all_offers_display_ingress_csm_counters","mbc_atc_cart_api_ajax_controller").register("mbc_cart_api_handler",function(a,b,c,f,d){function l(e){f.triggerUnitCounter(c.MBC_CART_API_ATC_CSM_FAILURE_METRIC_SCOPE_NAME);var a=e.offerIndex;b(c.MBC_OFFER_ADDED_TO_CART+
a).addClass(c.AUI_HIDE_ELEMENT_CSS_NAME);b(c.MBC_OFFER_NOT_ADDED_TO_CART+a).removeClass(c.AUI_HIDE_ELEMENT_CSS_NAME);g(e.offerIndex)}function g(a){b(c.MBC_OFFER_VIEW_CART_BUTTON+a).removeClass(c.AUI_HIDE_ELEMENT_CSS_NAME);b(c.MBC_OFFER_ATC_BUTTON_ID+a).addClass(c.AUI_HIDE_ELEMENT_CSS_NAME)}return{addToCart:function(a,m){var h=b(c.MBC_ATC_AJAX_ENDPOINT).val(),p=b(c.MBC_ATC_CSRF_TOKEN).val(),r=b(c.MBC_LANGUAGE_HEADER).val(),h={url:"https://"+h+"?ref\x3d"+a.refTag+"\x26sr\x3d"+a.sr+"\x26qid\x3d"+a.qid,
type:"POST",data:JSON.stringify({items:[{asin:a.asin,offerListingId:a.oid,quantity:a.minQty}]}),headers:{"Accept-Language":r,Accept:c.MBC_ATC_CART_API_HEADER_ACCEPT,"x-api-csrf-token":p,"Content-Type":c.MBC_ATC_CART_API_HEADER_CONTENT_TYPE},xhrFields:{withCredentials:!0},timeout:1E4,successHandler:function(n){n&&n.entity&&n.entity.items&&n.entity.items[0]&&0<n.entity.items[0].quantity?(n.entity.count&&n.entity.count.entity&&n.entity.count.entity.items?d.updateCartCount(n.entity.count.entity.items):
(f.triggerUnitCounter(c.MBC_CART_API_SUCCESS_COUNT_FAILURE_CSM_METRIC),d.updateCartCount(n.entity.items[0].quantity)),f.triggerUnitCounter(c.MBC_CART_API_ATC_CSM_SUCCESS_METRIC_SCOPE_NAME),m&&b(c.MBC_OFFER_ADDED_TO_CART+a.offerIndex).removeClass(c.AUI_HIDE_ELEMENT_CSS_NAME),g(a.offerIndex)):l(a);d.resetAjaxHandler()},errorHandler:function(b){422===b.status&&(b=JSON.parse(b.responseText))&&b.entity&&b.entity.items&&b.entity.items[0]&&(b.entity.count&&b.entity.count.entity&&b.entity.count.entity.items?
d.updateCartCount(b.entity.count.entity.items):(f.triggerUnitCounter(c.MBC_CART_API_ERROR_COUNT_FAILURE_CSM_METRIC),d.updateCartCount(b.entity.items[0].quantity)));l(a);d.resetAjaxHandler()}};d.mbcAtcAjaxCall(h)}}});f.register("mbc_constants",function(){return{MBC_ATC_AJAX_ENDPOINT:"#mbc-atc-ajax-endpoint",MBC_ATC_CSRF_TOKEN:"#mbc-atc-csrf-token",MBC_LANGUAGE_HEADER:"#mbc-language",MBC_OFFER_ADDED_TO_CART:"#mbc-offer-added-to-cart-",MBC_OFFER_NOT_ADDED_TO_CART:"#mbc-offer-not-added-to-cart-",MBC_OFFER_VIEW_CART_BUTTON:"#mbc-offer-view-cart-",
MBC_OFFER_ATC_BUTTON_ID:"#mbc-buybutton-addtocart-",MBC_ATC_CLICK_CANCELLED_CSM_METRIC:"mbc-atc-click-cancelled",MBC_ATC_CART_API_HEADER_ACCEPT:'application/vnd.com.amazon.api+json; type\x3d"cart.add-items/v1"',MBC_ATC_CART_API_HEADER_CONTENT_TYPE:'application/vnd.com.amazon.api+json; type\x3d"cart.add-items.request/v1"',MBC_NAV_API_CSM_METRIC_SCOPE_NAME:"mbc-nav-api-called",MBC_EWC_REFRESH_API_CSM_METRIC_SCOPE_NAME:"mbc-ewc-refresh-api-called",MBC_CART_API_SUCCESS_COUNT_FAILURE_CSM_METRIC:"mbc-cart-api-success-response-count-failure",
MBC_CART_API_ERROR_COUNT_FAILURE_CSM_METRIC:"mbc-cart-api-error-response-count-failure",MBC_CART_API_ATC_CSM_SUCCESS_METRIC_SCOPE_NAME:"mbc-cart-api-atc-success",MBC_CART_API_ATC_CSM_FAILURE_METRIC_SCOPE_NAME:"mbc-cart-api-atc-failure",MBC_WIDGET_TRIGGER_EVENTS:"click",AUI_HIDE_ELEMENT_CSS_NAME:"aok-hidden"}});"function"===typeof p&&p("ld","aod-ingress-assets-load-time",{wb:1})})});